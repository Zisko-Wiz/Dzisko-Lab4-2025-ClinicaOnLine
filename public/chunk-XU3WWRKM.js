import{A as rt,Aa as st,B as ke,C as zt,D as it,E as Q,Ma as Xt,P as he,Q as Jt,R as $r,S as Kt,Ta as xe,Wa as H,Xa as fe,aa as Yt,ba as k,c as Pr,f as Rr,fa as nt,fb as Qt,ga as N,h as Fr,ha as J,ja as de,l as Ur,ma as Nr}from"./chunk-XE42GBLL.js";import{b as Lr,c as Br,f as Rn,g as Gr}from"./chunk-LJ5XHLMQ.js";import{a as j,b as U,d as $,f as Mn,g as Pn,h}from"./chunk-FK42CRUA.js";var hr=$(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});var cr=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};ur.default=cr});var fr=$(Re=>{"use strict";var vi=Re&&Re.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Re,"__esModule",{value:!0});var Cs=vi((Gr(),Pn(Rn))),As=vi(hr()),dr=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Cs.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=Object.assign({},this.headers),this.headers[t]=e,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let r=this.fetch,n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>h(this,null,function*(){var o,a,l;let c=null,u=null,d=null,p=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){let b=yield s.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=b:u=JSON.parse(b))}let _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,p=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{let _=yield s.text();try{c=JSON.parse(_),Array.isArray(c)&&s.status===404&&(u=[],c=null,p=200,f="OK")}catch{s.status===404&&_===""?(p=204,f="No Content"):c={message:_}}if(c&&this.isMaybeSingle&&(!((l=c?.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,f="OK"),c&&this.shouldThrowOnError)throw new As.default(c)}return{error:c,data:u,count:d,status:p,statusText:f}}));return this.shouldThrowOnError||(n=n.catch(s=>{var o,a,l;return{error:{message:`${(o=s?.name)!==null&&o!==void 0?o:"FetchError"}: ${s?.message}`,details:`${(a=s?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=s?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}};Re.default=dr});var gr=$(Fe=>{"use strict";var Es=Fe&&Fe.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Fe,"__esModule",{value:!0});var Ss=Es(fr()),pr=class extends Ss.default{select(t){let e=!1,r=(t??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){let o=s?`${s}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){let n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:n=r}={}){let s=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:o="text"}={}){var a;let l=[t?"analyze":null,e?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Fe.default=pr});var At=$(Ue=>{"use strict";var ks=Ue&&Ue.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ue,"__esModule",{value:!0});var xs=ks(gr()),mr=class extends xs.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){let r=Array.from(new Set(e)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");let o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${s}fts${o}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){let n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}};Ue.default=mr});var vr=$(Ne=>{"use strict";var Ds=Ne&&Ne.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ne,"__esModule",{value:!0});var $e=Ds(At()),_r=class{constructor(t,{headers:e={},schema:r,fetch:n}){this.url=t,this.headers=e,this.schema=r,this.fetch=n}select(t,{head:e=!1,count:r}={}){let n=e?"HEAD":"GET",s=!1,o=(t??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new $e.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:r=!0}={}){let n="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){let o=t.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){let a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new $e.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){let o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){let l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){let c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new $e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){let r="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),e&&n.push(`count=${e}`),this.headers.Prefer=n.join(","),new $e.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){let e="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new $e.default({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ne.default=_r});var yi=$(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.version=void 0;Et.version="0.0.0-automated"});var wi=$(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.DEFAULT_HEADERS=void 0;var Os=yi();St.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Os.version}`}});var Ci=$(Le=>{"use strict";var bi=Le&&Le.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Le,"__esModule",{value:!0});var Ts=bi(vr()),Is=bi(At()),Vs=wi(),yr=class i{constructor(t,{headers:e={},schema:r,fetch:n}={}){this.url=t,this.headers=Object.assign(Object.assign({},Vs.DEFAULT_HEADERS),e),this.schemaName=r,this.fetch=n}from(t){let e=new URL(`${this.url}/${t}`);return new Ts.default(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new i(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:r=!1,get:n=!1,count:s}={}){let o,a=new URL(`${this.url}/rpc/${t}`),l;r||n?(o=r?"HEAD":"GET",Object.entries(e).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{a.searchParams.append(u,d)})):(o="POST",l=e);let c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new Is.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Le.default=yr});var Oi=$(D=>{"use strict";var me=D&&D.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(D,"__esModule",{value:!0});D.PostgrestError=D.PostgrestBuilder=D.PostgrestTransformBuilder=D.PostgrestFilterBuilder=D.PostgrestQueryBuilder=D.PostgrestClient=void 0;var Ai=me(Ci());D.PostgrestClient=Ai.default;var Ei=me(vr());D.PostgrestQueryBuilder=Ei.default;var Si=me(At());D.PostgrestFilterBuilder=Si.default;var ki=me(gr());D.PostgrestTransformBuilder=ki.default;var xi=me(fr());D.PostgrestBuilder=xi.default;var Di=me(hr());D.PostgrestError=Di.default;D.default={PostgrestClient:Ai.default,PostgrestQueryBuilder:Ei.default,PostgrestFilterBuilder:Si.default,PostgrestTransformBuilder:ki.default,PostgrestBuilder:xi.default,PostgrestError:Di.default}});var ji=$((ga,Vi)=>{"use strict";Vi.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var Xr=(()=>{class i{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,r){this._renderer=e,this._elementRef=r}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(r){return new(r||i)(k(Yt),k(Kt))};static \u0275dir=N({type:i})}return i})(),Un=(()=>{class i extends Xr{static \u0275fac=(()=>{let e;return function(n){return(e||(e=$r(i)))(n||i)}})();static \u0275dir=N({type:i,features:[J]})}return i})(),Qr=new Q("");var $n={provide:Qr,useExisting:ke(()=>Zr),multi:!0};function Nn(){let i=Qt()?Qt().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var Ln=new Q(""),Zr=(()=>{class i extends Xr{_compositionMode;_composing=!1;constructor(e,r,n){super(e,r),this._compositionMode=n,this._compositionMode==null&&(this._compositionMode=!Nn())}writeValue(e){let r=e??"";this.setProperty("value",r)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(r){return new(r||i)(k(Yt),k(Kt),k(Ln,8))};static \u0275dir=N({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,n){r&1&&st("input",function(o){return n._handleInput(o.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(o){return n._compositionEnd(o.target.value)})},standalone:!1,features:[xe([$n]),J]})}return i})();function tr(i){return i==null||rr(i)===0}function rr(i){return i==null?null:Array.isArray(i)||typeof i=="string"?i.length:i instanceof Set?i.size:null}var ir=new Q(""),nr=new Q(""),Bn=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,qr=class{static min(t){return Gn(t)}static max(t){return qn(t)}static required(t){return Hn(t)}static requiredTrue(t){return Wn(t)}static email(t){return zn(t)}static minLength(t){return Jn(t)}static maxLength(t){return Kn(t)}static pattern(t){return Yn(t)}static nullValidator(t){return ei()}static compose(t){return oi(t)}static composeAsync(t){return ai(t)}};function Gn(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}function qn(i){return t=>{if(t.value==null||i==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}function Hn(i){return tr(i.value)?{required:!0}:null}function Wn(i){return i.value===!0?null:{required:!0}}function zn(i){return tr(i.value)||Bn.test(i.value)?null:{email:!0}}function Jn(i){return t=>{let e=t.value?.length??rr(t.value);return e===null||e===0?null:e<i?{minlength:{requiredLength:i,actualLength:e}}:null}}function Kn(i){return t=>{let e=t.value?.length??rr(t.value);return e!==null&&e>i?{maxlength:{requiredLength:i,actualLength:e}}:null}}function Yn(i){if(!i)return ei;let t,e;return typeof i=="string"?(e="",i.charAt(0)!=="^"&&(e+="^"),e+=i,i.charAt(i.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),r=>{if(tr(r.value))return null;let n=r.value;return t.test(n)?null:{pattern:{requiredPattern:e,actualValue:n}}}}function ei(i){return null}function ti(i){return i!=null}function ri(i){return Nr(i)?Rr(i):i}function ii(i){let t={};return i.forEach(e=>{t=e!=null?j(j({},t),e):t}),Object.keys(t).length===0?null:t}function ni(i,t){return t.map(e=>e(i))}function Xn(i){return!i.validate}function si(i){return i.map(t=>Xn(t)?t:e=>t.validate(e))}function oi(i){if(!i)return null;let t=i.filter(ti);return t.length==0?null:function(e){return ii(ni(e,t))}}function sr(i){return i!=null?oi(si(i)):null}function ai(i){if(!i)return null;let t=i.filter(ti);return t.length==0?null:function(e){let r=ni(e,t).map(ri);return Ur(r).pipe(Fr(ii))}}function or(i){return i!=null?ai(si(i)):null}function Hr(i,t){return i===null?[t]:Array.isArray(i)?[...i,t]:[i,t]}function li(i){return i._rawValidators}function ci(i){return i._rawAsyncValidators}function Zt(i){return i?Array.isArray(i)?i:[i]:[]}function at(i,t){return Array.isArray(i)?i.includes(t):i===t}function Wr(i,t){let e=Zt(t);return Zt(i).forEach(n=>{at(e,n)||e.push(n)}),e}function zr(i,t){return Zt(t).filter(e=>!at(i,e))}var lt=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=sr(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=or(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},K=class extends lt{name;get formDirective(){return null}get path(){return null}},je=class extends lt{_parent=null;name=null;valueAccessor=null},ct=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},Qn={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Uo=U(j({},Qn),{"[class.ng-submitted]":"isSubmitted"}),$o=(()=>{class i extends ct{constructor(e){super(e)}static \u0275fac=function(r){return new(r||i)(k(je,2))};static \u0275dir=N({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,n){r&2&&Xt("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)},standalone:!1,features:[J]})}return i})(),No=(()=>{class i extends ct{constructor(e){super(e)}static \u0275fac=function(r){return new(r||i)(k(K,10))};static \u0275dir=N({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,n){r&2&&Xt("ng-untouched",n.isUntouched)("ng-touched",n.isTouched)("ng-pristine",n.isPristine)("ng-dirty",n.isDirty)("ng-valid",n.isValid)("ng-invalid",n.isInvalid)("ng-pending",n.isPending)("ng-submitted",n.isSubmitted)},standalone:!1,features:[J]})}return i})();var De="VALID",ot="INVALID",pe="PENDING",Oe="DISABLED",Y=class{},ut=class extends Y{value;source;constructor(t,e){super(),this.value=t,this.source=e}},Ie=class extends Y{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},Ve=class extends Y{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},ge=class extends Y{status;source;constructor(t,e){super(),this.status=t,this.source=e}},ht=class extends Y{source;constructor(t){super(),this.source=t}},dt=class extends Y{source;constructor(t){super(),this.source=t}};function ui(i){return(_t(i)?i.validators:i)||null}function Zn(i){return Array.isArray(i)?sr(i):i||null}function hi(i,t){return(_t(t)?t.asyncValidators:i)||null}function es(i){return Array.isArray(i)?or(i):i||null}function _t(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}function ts(i,t,e){let r=i.controls;if(!(t?Object.keys(r):r).length)throw new rt(1e3,"");if(!r[e])throw new rt(1001,"")}function rs(i,t,e){i._forEachChild((r,n)=>{if(e[n]===void 0)throw new rt(1002,"")})}var ft=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return H(this.statusReactive)}set status(t){H(()=>this.statusReactive.set(t))}_status=fe(()=>this.statusReactive());statusReactive=he(void 0);get valid(){return this.status===De}get invalid(){return this.status===ot}get pending(){return this.status==pe}get disabled(){return this.status===Oe}get enabled(){return this.status!==Oe}errors;get pristine(){return H(this.pristineReactive)}set pristine(t){H(()=>this.pristineReactive.set(t))}_pristine=fe(()=>this.pristineReactive());pristineReactive=he(!0);get dirty(){return!this.pristine}get touched(){return H(this.touchedReactive)}set touched(t){H(()=>this.touchedReactive.set(t))}_touched=fe(()=>this.touchedReactive());touchedReactive=he(!1);get untouched(){return!this.touched}_events=new Pr;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(Wr(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Wr(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(zr(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(zr(t,this._rawAsyncValidators))}hasValidator(t){return at(this._rawValidators,t)}hasAsyncValidator(t){return at(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let r=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(U(j({},t),{sourceControl:r})),e&&t.emitEvent!==!1&&this._events.next(new Ve(!0,r))}markAllAsDirty(t={}){this.markAsDirty({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsDirty(t))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=t.sourceControl??this;this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:r})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,r),e&&t.emitEvent!==!1&&this._events.next(new Ve(!1,r))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let r=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(U(j({},t),{sourceControl:r})),e&&t.emitEvent!==!1&&this._events.next(new Ie(!1,r))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=t.sourceControl??this;this._forEachChild(n=>{n.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,r),e&&t.emitEvent!==!1&&this._events.next(new Ie(!0,r))}markAsPending(t={}){this.status=pe;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new ge(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(U(j({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Oe,this.errors=null,this._forEachChild(n=>{n.disable(U(j({},t),{onlySelf:!0}))}),this._updateValue();let r=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new ut(this.value,r)),this._events.next(new ge(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(U(j({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(n=>n(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=De,this._forEachChild(r=>{r.enable(U(j({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(U(j({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===De||this.status===pe)&&this._runAsyncValidator(r,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new ut(this.value,e)),this._events.next(new ge(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(U(j({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Oe:De}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=pe,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1,shouldHaveEmitted:t!==!1};let r=ri(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(n=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(n,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((r,n)=>r&&r._find(n),this)}getError(t,e){let r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,r){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||r)&&this._events.next(new ge(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,r)}_initObservables(){this.valueChanges=new de,this.statusChanges=new de}_calculateStatus(){return this._allControlsDisabled()?Oe:this.errors?ot:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(pe)?pe:this._anyControlsHaveStatus(ot)?ot:De}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let r=!this._anyControlsDirty(),n=this.pristine!==r;this.pristine=r,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),n&&this._events.next(new Ie(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Ve(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){_t(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=Zn(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=es(this._rawAsyncValidators)}},pt=class extends ft{constructor(t,e,r){super(ui(e),hi(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){rs(this,!0,t),Object.keys(t).forEach(r=>{ts(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(r=>{let n=this.controls[r];n&&n.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,n)=>{r.reset(t?t[n]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>r._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,r,n)=>((r.enabled||this.disabled)&&(e[n]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((n,s)=>{r=e(r,n,s)}),r}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var vt=new Q("",{providedIn:"root",factory:()=>yt}),yt="always";function is(i,t){return[...t.path,i]}function er(i,t,e=yt){ar(i,t),t.valueAccessor.writeValue(i.value),(i.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(i.disabled),ss(i,t),as(i,t),os(i,t),ns(i,t)}function Jr(i,t,e=!0){let r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),mt(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function gt(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function ns(i,t){if(t.valueAccessor.setDisabledState){let e=r=>{t.valueAccessor.setDisabledState(r)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}function ar(i,t){let e=li(i);t.validator!==null?i.setValidators(Hr(e,t.validator)):typeof e=="function"&&i.setValidators([e]);let r=ci(i);t.asyncValidator!==null?i.setAsyncValidators(Hr(r,t.asyncValidator)):typeof r=="function"&&i.setAsyncValidators([r]);let n=()=>i.updateValueAndValidity();gt(t._rawValidators,n),gt(t._rawAsyncValidators,n)}function mt(i,t){let e=!1;if(i!==null){if(t.validator!==null){let n=li(i);if(Array.isArray(n)&&n.length>0){let s=n.filter(o=>o!==t.validator);s.length!==n.length&&(e=!0,i.setValidators(s))}}if(t.asyncValidator!==null){let n=ci(i);if(Array.isArray(n)&&n.length>0){let s=n.filter(o=>o!==t.asyncValidator);s.length!==n.length&&(e=!0,i.setAsyncValidators(s))}}}let r=()=>{};return gt(t._rawValidators,r),gt(t._rawAsyncValidators,r),e}function ss(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&di(i,t)})}function os(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&di(i,t),i.updateOn!=="submit"&&i.markAsTouched()})}function di(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function as(i,t){let e=(r,n)=>{t.valueAccessor.writeValue(r),n&&t.viewToModelUpdate(r)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}function fi(i,t){i==null,ar(i,t)}function ls(i,t){return mt(i,t)}function cs(i,t){if(!i.hasOwnProperty("model"))return!1;let e=i.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function us(i){return Object.getPrototypeOf(i.constructor)===Un}function pi(i,t){i._syncPendingControls(),t.forEach(e=>{let r=e.control;r.updateOn==="submit"&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function hs(i,t){if(!t)return null;Array.isArray(t);let e,r,n;return t.forEach(s=>{s.constructor===Zr?e=s:us(s)?r=s:n=s}),n||r||e||null}function ds(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}var fs={provide:K,useExisting:ke(()=>ps)},Te=Promise.resolve(),ps=(()=>{class i extends K{callSetDisabledState;get submitted(){return H(this.submittedReactive)}_submitted=fe(()=>this.submittedReactive());submittedReactive=he(!1);_directives=new Set;form;ngSubmit=new de;options;constructor(e,r,n){super(),this.callSetDisabledState=n,this.form=new pt({},sr(e),or(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Te.then(()=>{let r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),er(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Te.then(()=>{let r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Te.then(()=>{let r=this._findContainer(e.path),n=new pt({});fi(n,e),r.registerControl(e.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Te.then(()=>{let r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){Te.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),pi(this.form,this._directives),this.ngSubmit.emit(e),this.form._events.next(new ht(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1),this.form._events.next(new dt(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static \u0275fac=function(r){return new(r||i)(k(ir,10),k(nr,10),k(vt,8))};static \u0275dir=N({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,n){r&1&&st("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[xe([fs]),J]})}return i})();function Kr(i,t){let e=i.indexOf(t);e>-1&&i.splice(e,1)}function Yr(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var gs=class extends ft{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,r){super(ui(e),hi(r,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),_t(e)&&(e.nonNullable||e.initialValueIsDefault)&&(Yr(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Kr(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Kr(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){Yr(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var ms=i=>i instanceof gs;var Bo=(()=>{class i{static \u0275fac=function(r){return new(r||i)};static \u0275dir=N({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return i})();var gi=new Q("");var _s={provide:K,useExisting:ke(()=>vs)},vs=(()=>{class i extends K{callSetDisabledState;get submitted(){return H(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=fe(()=>this._submittedReactive());_submittedReactive=he(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new de;constructor(e,r,n){super(),this.callSetDisabledState=n,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(mt(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let r=this.form.get(e.path);return er(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Jr(e.control||null,e,!1),ds(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this._submittedReactive.set(!0),pi(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new ht(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0,r={}){this.form.reset(e,r),this._submittedReactive.set(!1),r?.emitEvent!==!1&&this.form._events.next(new dt(this.form))}_updateDomValue(){this.directives.forEach(e=>{let r=e.control,n=this.form.get(e.path);r!==n&&(Jr(r||null,e),ms(n)&&(er(n,e,this.callSetDisabledState),e.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let r=this.form.get(e.path);fi(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let r=this.form.get(e.path);r&&ls(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){ar(this.form,this),this._oldForm&&mt(this._oldForm,this)}static \u0275fac=function(r){return new(r||i)(k(ir,10),k(nr,10),k(vt,8))};static \u0275dir=N({type:i,selectors:[["","formGroup",""]],hostBindings:function(r,n){r&1&&st("submit",function(o){return n.onSubmit(o)})("reset",function(){return n.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[xe([_s]),J,Jt]})}return i})();var ys={provide:je,useExisting:ke(()=>ws)},ws=(()=>{class i extends je{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new de;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,r,n,s,o){super(),this._ngModelWarningConfig=o,this._parent=e,this._setValidators(r),this._setAsyncValidators(n),this.valueAccessor=hs(this,s)}ngOnChanges(e){this._added||this._setUpControl(),cs(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return is(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||i)(k(K,13),k(ir,10),k(nr,10),k(Qr,10),k(gi,8))};static \u0275dir=N({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[xe([ys]),J,Jt]})}return i})();var mi=(()=>{class i{static \u0275fac=function(r){return new(r||i)};static \u0275mod=nt({type:i});static \u0275inj=it({})}return i})();var Go=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:vt,useValue:e.callSetDisabledState??yt}]}}static \u0275fac=function(r){return new(r||i)};static \u0275mod=nt({type:i});static \u0275inj=it({imports:[mi]})}return i})(),qo=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:gi,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:vt,useValue:e.callSetDisabledState??yt}]}}static \u0275fac=function(r){return new(r||i)};static \u0275mod=nt({type:i});static \u0275inj=it({imports:[mi]})}return i})();var _i=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...e)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)};var Me=class extends Error{constructor(t,e="FunctionsError",r){super(t),this.name=e,this.context=r}},wt=class extends Me{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},bt=class extends Me{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},Ct=class extends Me{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}},lr=function(i){return i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2",i}(lr||{});var bs=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Pe=class{constructor(t,{headers:e={},customFetch:r,region:n=lr.Any}={}){this.url=t,this.headers=e,this.region=n,this.fetch=_i(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var r;return bs(this,void 0,void 0,function*(){try{let{headers:n,method:s,body:o}=e,a={},{region:l}=e;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));let u=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:c}).catch(w=>{throw new wt(w)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new bt(u);if(!u.ok)throw new Ct(u);let p=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield u.json():p==="application/octet-stream"?f=yield u.blob():p==="text/event-stream"?f=u:p==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(n){return{data:null,error:n}}})}};var Ti=Mn(Oi(),1),{PostgrestClient:Ii,PostgrestQueryBuilder:ua,PostgrestFilterBuilder:ha,PostgrestTransformBuilder:da,PostgrestBuilder:fa,PostgrestError:js}=Ti.default;var wr;typeof window>"u"?wr=ji():wr=window.WebSocket;var Mi=wr;var Pi="2.11.10";var Ri={"X-Client-Info":`realtime-js/${Pi}`},Fi="1.0.0";var kt=1e4,Ui=1e3,_e=function(i){return i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed",i}(_e||{}),O=function(i){return i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving",i}(O||{}),M=function(i){return i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token",i}(M||{}),br=function(i){return i.websocket="websocket",i}(br||{}),Z=function(i){return i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed",i}(Z||{});var xt=class{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){let e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}_decodeBroadcast(t,e,r){let n=e.getUint8(1),s=e.getUint8(2),o=this.HEADER_LENGTH+2,a=r.decode(t.slice(o,o+n));o=o+n;let l=r.decode(t.slice(o,o+s));o=o+s;let c=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:a,event:l,payload:c}}};var ve=class{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var A=function(i){return i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange",i}(A||{}),Ar=(i,t,e={})=>{var r;let n=(r=e.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((s,o)=>(s[o]=Ms(o,i,t,n),s),{})},Ms=(i,t,e,r)=>{let n=t.find(a=>a.name===i),s=n?.type,o=e[i];return s&&!r.includes(s)?$i(s,o):Cr(o)},$i=(i,t)=>{if(i.charAt(0)==="_"){let e=i.slice(1,i.length);return Us(t,e)}switch(i){case A.bool:return Ps(t);case A.float4:case A.float8:case A.int2:case A.int4:case A.int8:case A.numeric:case A.oid:return Rs(t);case A.json:case A.jsonb:return Fs(t);case A.timestamp:return $s(t);case A.abstime:case A.date:case A.daterange:case A.int4range:case A.int8range:case A.money:case A.reltime:case A.text:case A.time:case A.timestamptz:case A.timetz:case A.tsrange:case A.tstzrange:return Cr(t);default:return Cr(t)}},Cr=i=>i,Ps=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Rs=i=>{if(typeof i=="string"){let t=parseFloat(i);if(!Number.isNaN(t))return t}return i},Fs=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(t){return console.log(`JSON parse error: ${t}`),i}return i},Us=(i,t)=>{if(typeof i!="string")return i;let e=i.length-1,r=i[e];if(i[0]==="{"&&r==="}"){let s,o=i.slice(1,e);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>$i(t,a))}return i},$s=i=>typeof i=="string"?i.replace(" ","T"):i,Dt=i=>{let t=i;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};var ye=class{constructor(t,e,r={},n=kt){this.channel=t,this.event=e,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}};var Be=class i{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{let{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=i.syncState(this.state,n,s,o),this.pendingDiffs.forEach(l=>{this.state=i.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},n=>{let{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=i.syncDiff(this.state,n,s,o),a())}),this.onJoin((n,s,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:o})}),this.onLeave((n,s,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,n){let s=this.cloneDeep(t),o=this.transformState(e),a={},l={};return this.map(s,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{let d=s[c];if(d){let p=u.map(v=>v.presence_ref),f=d.map(v=>v.presence_ref),w=u.filter(v=>f.indexOf(v.presence_ref)<0),_=d.filter(v=>p.indexOf(v.presence_ref)<0);w.length>0&&(a[c]=w),_.length>0&&(l[c]=_)}else a[c]=u}),this.syncDiff(s,{joins:a,leaves:l},r,n)}static syncDiff(t,e,r,n){let{joins:s,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(s,(a,l)=>{var c;let u=(c=t[a])!==null&&c!==void 0?c:[];if(t[a]=this.cloneDeep(l),u.length>0){let d=t[a].map(f=>f.presence_ref),p=u.filter(f=>d.indexOf(f.presence_ref)<0);t[a].unshift(...p)}r(a,u,l)}),this.map(o,(a,l)=>{let c=t[a];if(!c)return;let u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),t[a]=c,n(a,c,l),c.length===0&&delete t[a]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{let n=t[r];return"metas"in n?e[r]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[r]=n,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var W=function(i){return i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR",i}(W||{});var Ge=class i{constructor(t,e={config:{}},r){this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=O.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new ye(this,M.join,this.params,this.timeout),this.rejoinTimer=new ve(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=O.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=O.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=O.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=O.errored,this.rejoinTimer.scheduleTimeout())}),this._on(M.reply,{},(n,s)=>{this._trigger(this._replyEventName(s),n)}),this.presence=new Be(this),this.broadcastEndpointURL=Dt(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,e=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:s,presence:o,private:a}}=this.params;this._onError(u=>t?.(W.CHANNEL_ERROR,u)),this._onClose(()=>t?.(W.CLOSED));let l={},c={broadcast:s,presence:o,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",d=>h(this,[d],function*({postgres_changes:u}){var p;if(this.socket.setAuth(),u===void 0){t?.(W.SUBSCRIBED);return}else{let f=this.bindings.postgres_changes,w=(p=f?.length)!==null&&p!==void 0?p:0,_=[];for(let v=0;v<w;v++){let b=f[v],{filter:{event:x,schema:T,table:g,filter:C}}=b,F=u&&u[v];if(F&&F.event===x&&F.schema===T&&F.table===g&&F.filter===C)_.push(Object.assign(Object.assign({},b),{id:F.id}));else{this.unsubscribe(),this.state=O.errored,t?.(W.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,t&&t(W.SUBSCRIBED);return}})).receive("error",u=>{this.state=O.errored,t?.(W.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t?.(W.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(r){return h(this,arguments,function*(t,e={}){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(){return h(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,r){return this._on(t,e,r)}send(r){return h(this,arguments,function*(t,e={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){let{event:o,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{let u=yield this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=e.timeout)!==null&&n!==void 0?n:this.timeout);return yield(s=u.body)===null||s===void 0?void 0:s.cancel(),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,c;let u=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("error",()=>o("error")),u.receive("timeout",()=>o("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=O.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(M.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(r=>{let n=new ye(this,M.leave,{},t);n.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}_fetchWithTimeout(t,e,r){return h(this,null,function*(){let n=new AbortController,s=setTimeout(()=>n.abort(),r),o=yield this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:n.signal}));return clearTimeout(s),o})}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new ye(this,t,e,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var n,s;let o=t.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=M;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let p=this._onMessage(o,e,r);if(e&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var w,_,v;return((w=f.filter)===null||w===void 0?void 0:w.event)==="*"||((v=(_=f.filter)===null||_===void 0?void 0:_.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(f=>f.callback(p,r)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var w,_,v,b,x,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){let g=f.id,C=(w=f.filter)===null||w===void 0?void 0:w.event;return g&&((_=e.ids)===null||_===void 0?void 0:_.includes(g))&&(C==="*"||C?.toLocaleLowerCase()===((v=e.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{let g=(x=(b=f?.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return g==="*"||g===((T=e?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof p=="object"&&"ids"in p){let w=p.data,{schema:_,table:v,commit_timestamp:b,type:x,errors:T}=w;p=Object.assign(Object.assign({},{schema:_,table:v,commit_timestamp:b,eventType:x,new:{},old:{},errors:T}),this._getPayloadRecords(w))}f.callback(p,r)})}_isClosed(){return this.state===O.closed}_isJoined(){return this.state===O.joined}_isJoining(){return this.state===O.joining}_isLeaving(){return this.state===O.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){let n=t.toLocaleLowerCase(),s={type:n,filter:e,callback:r};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(t,e){let r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&i.isEqual(n.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(M.close,{},t)}_onError(t){this._on(M.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=O.joining,this.joinPush.resend(t))}_getPayloadRecords(t){let e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Ar(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Ar(t.columns,t.old_record)),e}};var Ni=()=>{},Ls=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,qe=class{constructor(t,e){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Ri,this.params={},this.timeout=kt,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ni,this.ref=0,this.logger=Ni,this.conn=null,this.sendBuffer=[],this.serializer=new xt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...a)=>import("./chunk-BX7VDEVO.js").then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${t}/${br.websocket}`,this.httpEndpoint=Dt(t),e?.transport?this.transport=e.transport:this.transport=null,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);let n=(r=e?.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e?.encode?e.encode:(s,o)=>o(JSON.stringify(s)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ve(()=>h(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(e?.fetch),e?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=e?.worker||!1,this.workerUrl=e?.workerUrl}this.accessToken=e?.accessToken||null}connect(){if(!this.conn){if(this.transport||(this.transport=Mi),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Er(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Fi}))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}removeChannel(t){return h(this,null,function*(){let e=yield t.unsubscribe();return this.channels=this.channels.filter(r=>r._joinRef!==t._joinRef),this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return h(this,null,function*(){let t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t})}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case _e.connecting:return Z.Connecting;case _e.open:return Z.Open;case _e.closing:return Z.Closing;default:return Z.Closed}}isConnected(){return this.connectionState()===Z.Open}channel(t,e={config:{}}){let r=`realtime:${t}`,n=this.getChannels().find(s=>s.topic===r);if(n)return n;{let s=new Ge(`realtime:${t}`,e,this);return this.channels.push(s),s}}push(t){let{topic:e,event:r,payload:n,ref:s}=t,o=()=>{this.encode(t,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${e} ${r} (${s})`,n),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(t=null){return h(this,null,function*(){let e=t||this.accessToken&&(yield this.accessToken())||this.accessTokenValue;this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(r=>{e&&r.updateJoinPayload({access_token:e,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(M.access_token,{access_token:e})}))})}sendHeartbeat(){return h(this,null,function*(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(Ui,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),yield this.setAuth()})}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:r,event:n,payload:s,ref:o}=e;r==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(e.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${n} ${o&&"("+o+")"||""}`,s),Array.from(this.channels).filter(a=>a._isMember(r)).forEach(a=>a._trigger(n,s,o)),this.stateChangeCallbacks.message.forEach(a=>a(e))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(M.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;let r=t.match(/\?/)?"&":"?",n=new URLSearchParams(e);return`${t}${r}${n}`}_workerObjectUrl(t){let e;if(t)e=t;else{let r=new Blob([Ls],{type:"application/javascript"});e=URL.createObjectURL(r)}return e}};var Er=class{constructor(t,e,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=_e.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}};var we=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function S(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var Ot=class extends we{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}},ee=class extends we{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};var Bs=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},It=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...e)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},Li=()=>Bs(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-BX7VDEVO.js")).Response:Response}),Tt=i=>{if(Array.isArray(i))return i.map(e=>Tt(e));if(typeof i=="function"||i!==Object(i))return i;let t={};return Object.entries(i).forEach(([e,r])=>{let n=e.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[n]=Tt(r)}),t};var te=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Sr=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Gs=(i,t,e)=>te(void 0,void 0,void 0,function*(){let r=yield Li();i instanceof r&&!e?.noResolveJson?i.json().then(n=>{t(new Ot(Sr(n),i.status||500))}).catch(n=>{t(new ee(Sr(n),n))}):t(new ee(Sr(i),i))}),qs=(i,t,e,r)=>{let n={method:i,headers:t?.headers||{}};return i==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},t?.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),e))};function He(i,t,e,r,n,s){return te(this,void 0,void 0,function*(){return new Promise((o,a)=>{i(e,qs(t,r,n,s)).then(l=>{if(!l.ok)throw l;return r?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Gs(l,a,r))})})}function be(i,t,e,r){return te(this,void 0,void 0,function*(){return He(i,"GET",t,e,r)})}function L(i,t,e,r,n){return te(this,void 0,void 0,function*(){return He(i,"POST",t,r,n,e)})}function Bi(i,t,e,r,n){return te(this,void 0,void 0,function*(){return He(i,"PUT",t,r,n,e)})}function Gi(i,t,e,r){return te(this,void 0,void 0,function*(){return He(i,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),r)})}function Vt(i,t,e,r,n){return te(this,void 0,void 0,function*(){return He(i,"DELETE",t,r,n,e)})}var I=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Hs={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qi={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},jt=class{constructor(t,e={},r,n){this.url=t,this.headers=e,this.bucketId=r,this.fetch=It(n)}uploadOrUpdate(t,e,r,n){return I(this,void 0,void 0,function*(){try{let s,o=Object.assign(Object.assign({},qi),n),a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)}),l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(a=Object.assign(Object.assign({},a),n.headers));let c=this._removeEmptyFolders(e),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:s,headers:a},o?.duplex?{duplex:o.duplex}:{})),p=yield d.json();return d.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(s){if(S(s))return{data:null,error:s};throw s}})}upload(t,e,r){return I(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,n){return I(this,void 0,void 0,function*(){let s=this._removeEmptyFolders(t),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l,c=Object.assign({upsert:qi.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);let d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),p=yield d.json();return d.ok?{data:{path:s,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(S(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,e){return I(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),n=Object.assign({},this.headers);e?.upsert&&(n["x-upsert"]="true");let s=yield L(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+s.url),a=o.searchParams.get("token");if(!a)throw new we("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}})}update(t,e,r){return I(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e,r){return I(this,void 0,void 0,function*(){try{return{data:yield L(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(S(n))return{data:null,error:n};throw n}})}copy(t,e,r){return I(this,void 0,void 0,function*(){try{return{data:{path:(yield L(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(S(n))return{data:null,error:n};throw n}})}createSignedUrl(t,e,r){return I(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),s=yield L(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:this.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(n){if(S(n))return{data:null,error:n};throw n}})}createSignedUrls(t,e,r){return I(this,void 0,void 0,function*(){try{let n=yield L(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(n){if(S(n))return{data:null,error:n};throw n}})}download(t,e){return I(this,void 0,void 0,function*(){let n=typeof e?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(e?.transform||{}),o=s?`?${s}`:"";try{let a=this._getFinalPath(t);return{data:yield(yield be(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(S(a))return{data:null,error:a};throw a}})}info(t){return I(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{let r=yield be(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Tt(r),error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}})}exists(t){return I(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{return yield Gi(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(S(r)&&r instanceof ee){let n=r.originalError;if([400,404].includes(n?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,e){let r=this._getFinalPath(t),n=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&n.push(s);let a=typeof e?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(e?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(t){return I(this,void 0,void 0,function*(){try{return{data:yield Vt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(S(e))return{data:null,error:e};throw e}})}list(t,e,r){return I(this,void 0,void 0,function*(){try{let n=Object.assign(Object.assign(Object.assign({},Hs),e),{prefix:t||""});return{data:yield L(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(S(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){let e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};var Hi="2.7.1";var Wi={"X-Client-Info":`storage-js/${Hi}`};var Ce=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Mt=class{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},Wi),e),this.fetch=It(r)}listBuckets(){return Ce(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}})}getBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(S(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return Ce(this,void 0,void 0,function*(){try{return{data:yield L(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return Ce(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield L(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(S(e))return{data:null,error:e};throw e}})}deleteBucket(t){return Ce(this,void 0,void 0,function*(){try{return{data:yield Vt(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(S(e))return{data:null,error:e};throw e}})}};var We=class extends Mt{constructor(t,e={},r){super(t,e,r)}from(t){return new jt(this.url,this.headers,t,this.fetch)}};var zi="2.50.0";var ze="";typeof Deno<"u"?ze="deno":typeof document<"u"?ze="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ze="react-native":ze="node";var Ws={"X-Client-Info":`supabase-js-${ze}/${zi}`},Ji={headers:Ws},Ki={schema:"public"},Yi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Xi={};Gr();var zs=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Js=i=>{let t;return i?t=i:typeof fetch>"u"?t=Lr:t=fetch,(...e)=>t(...e)},Ks=()=>typeof Headers>"u"?Br:Headers,Qi=(i,t,e)=>{let r=Js(e),n=Ks();return(s,o)=>zs(void 0,void 0,void 0,function*(){var a;let l=(a=yield t())!==null&&a!==void 0?a:i,c=new n(o?.headers);return c.has("apikey")||c.set("apikey",i),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},o),{headers:c}))})};var Ys=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})};function Zi(i){return i.endsWith("/")?i:i+"/"}function en(i,t){var e,r;let{db:n,auth:s,realtime:o,global:a}=i,{db:l,auth:c,realtime:u,global:d}=t,p={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},(e=d?.headers)!==null&&e!==void 0?e:{}),(r=a?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Ys(this,void 0,void 0,function*(){return""})};return i.accessToken?p.accessToken=i.accessToken:delete p.accessToken,p}var Pt="2.70.0";var re=30*1e3,Rt=3,Ft=Rt*re,tn="http://localhost:9999",rn="supabase.auth.token";var nn={"X-Client-Info":`gotrue-js/${Pt}`};var Je="X-Supabase-Api-Version",kr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},sn=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,on=6e5;var Ke=class extends Error{constructor(t,e,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=r}};function m(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}var Ut=class extends Ke{constructor(t,e,r){super(t,e,r),this.name="AuthApiError",this.status=e,this.code=r}};function an(i){return m(i)&&i.name==="AuthApiError"}var Ae=class extends Ke{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}},B=class extends Ke{constructor(t,e,r,n){super(t,r,n),this.name=e,this.status=r}},P=class extends B{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function ln(i){return m(i)&&i.name==="AuthSessionMissingError"}var ie=class extends B{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},ne=class extends B{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},se=class extends B{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function cn(i){return m(i)&&i.name==="AuthImplicitGrantRedirectError"}var Ye=class extends B{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Ee=class extends B{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}};function $t(i){return m(i)&&i.name==="AuthRetryableFetchError"}var Xe=class extends B{constructor(t,e,r){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=r}};var z=class extends B{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};var Nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),un=` 	
\r=`.split(""),Xs=(()=>{let i=new Array(128);for(let t=0;t<i.length;t+=1)i[t]=-1;for(let t=0;t<un.length;t+=1)i[un[t].charCodeAt(0)]=-2;for(let t=0;t<Nt.length;t+=1)i[Nt[t].charCodeAt(0)]=t;return i})();function hn(i,t,e){if(i!==null)for(t.queue=t.queue<<8|i,t.queuedBits+=8;t.queuedBits>=6;){let r=t.queue>>t.queuedBits-6&63;e(Nt[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){let r=t.queue>>t.queuedBits-6&63;e(Nt[r]),t.queuedBits-=6}}function dn(i,t,e){let r=Xs[i];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function xr(i){let t=[],e=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=o=>{eo(o,r,e)};for(let o=0;o<i.length;o+=1)dn(i.charCodeAt(o),n,s);return t.join("")}function Qs(i,t){if(i<=127){t(i);return}else if(i<=2047){t(192|i>>6),t(128|i&63);return}else if(i<=65535){t(224|i>>12),t(128|i>>6&63),t(128|i&63);return}else if(i<=1114111){t(240|i>>18),t(128|i>>12&63),t(128|i>>6&63),t(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function Zs(i,t){for(let e=0;e<i.length;e+=1){let r=i.charCodeAt(e);if(r>55295&&r<=56319){let n=(r-55296)*1024&65535;r=(i.charCodeAt(e+1)-56320&65535|n)+65536,e+=1}Qs(r,t)}}function eo(i,t,e){if(t.utf8seq===0){if(i<=127){e(i);return}for(let r=1;r<6;r+=1)if((i>>7-r&1)===0){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=i&31;else if(t.utf8seq===3)t.codepoint=i&15;else if(t.utf8seq===4)t.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|i&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function fn(i){let t=[],e={queue:0,queuedBits:0},r=n=>{t.push(n)};for(let n=0;n<i.length;n+=1)dn(i.charCodeAt(n),e,r);return new Uint8Array(t)}function pn(i){let t=[];return Zs(i,e=>t.push(e)),new Uint8Array(t)}function gn(i){let t=[],e={queue:0,queuedBits:0},r=n=>{t.push(n)};return i.forEach(n=>hn(n,e,r)),hn(null,e,r),t.join("")}function mn(i){return Math.round(Date.now()/1e3)+i}function _n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){let t=Math.random()*16|0;return(i=="x"?t:t&3|8).toString(16)})}var R=()=>typeof window<"u"&&typeof document<"u",oe={tested:!1,writable:!1},X=()=>{if(!R())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(oe.tested)return oe.writable;let i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),oe.tested=!0,oe.writable=!0}catch{oe.tested=!0,oe.writable=!1}return oe.writable};function vn(i){let t={},e=new URL(i);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((n,s)=>{t[s]=n})}catch{}return e.searchParams.forEach((r,n)=>{t[n]=r}),t}var Lt=i=>{let t;return i?t=i:typeof fetch>"u"?t=(...e)=>import("./chunk-BX7VDEVO.js").then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},yn=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Dr=(i,t,e)=>h(null,null,function*(){yield i.setItem(t,JSON.stringify(e))}),Ze=(i,t)=>h(null,null,function*(){let e=yield i.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),et=(i,t)=>h(null,null,function*(){yield i.removeItem(t)}),Qe=class i{constructor(){this.promise=new i.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}};Qe.promiseConstructor=Promise;function Bt(i){let t=i.split(".");if(t.length!==3)throw new z("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!sn.test(t[r]))throw new z("JWT not in base64url format");return{header:JSON.parse(xr(t[0])),payload:JSON.parse(xr(t[1])),signature:fn(t[2]),raw:{header:t[0],payload:t[1]}}}function wn(i){return h(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),i)})})}function bn(i,t){return new Promise((r,n)=>{h(null,null,function*(){for(let s=0;s<1/0;s++)try{let o=yield i(s);if(!t(s,null,o)){r(o);return}}catch(o){if(!t(s,o)){n(o);return}}})})}function to(i){return("0"+i.toString(16)).substr(-2)}function ro(){let t=new Uint32Array(56);if(typeof crypto>"u"){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length,n="";for(let s=0;s<56;s++)n+=e.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(t),Array.from(t,to).join("")}function io(i){return h(this,null,function*(){let e=new TextEncoder().encode(i),r=yield crypto.subtle.digest("SHA-256",e),n=new Uint8Array(r);return Array.from(n).map(s=>String.fromCharCode(s)).join("")})}function no(i){return h(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;let e=yield io(i);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function ae(i,t,e=!1){return h(this,null,function*(){let r=ro(),n=r;e&&(n+="/PASSWORD_RECOVERY"),yield Dr(i,`${t}-code-verifier`,n);let s=yield no(r);return[s,r===s?"plain":"s256"]})}var so=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Cn(i){let t=i.headers.get(Je);if(!t||!t.match(so))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function An(i){if(!i)throw new Error("Missing exp claim");let t=Math.floor(Date.now()/1e3);if(i<=t)throw new Error("JWT has expired")}function En(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var oo=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function le(i){if(!oo.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var ao=function(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(e[r[n]]=i[r[n]]);return e},ce=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),lo=[502,503,504];function Sn(i){return h(this,null,function*(){var t;if(!yn(i))throw new Ee(ce(i),0);if(lo.includes(i.status))throw new Ee(ce(i),i.status);let e;try{e=yield i.json()}catch(s){throw new Ae(ce(s),s)}let r,n=Cn(i);if(n&&n.getTime()>=kr["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?r=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(r=e.error_code),r){if(r==="weak_password")throw new Xe(ce(e),i.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new P}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new Xe(ce(e),i.status,e.weak_password.reasons);throw new Ut(ce(e),i.status||500,r)})}var co=(i,t,e,r)=>{let n={method:i,headers:t?.headers||{}};return i==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),e))};function y(i,t,e,r){return h(this,null,function*(){var n;let s=Object.assign({},r?.headers);s[Je]||(s[Je]=kr["2024-01-01"].name),r?.jwt&&(s.Authorization=`Bearer ${r.jwt}`);let o=(n=r?.query)!==null&&n!==void 0?n:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield uo(i,t,e+a,{headers:s,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(l):{data:Object.assign({},l),error:null}})}function uo(i,t,e,r,n,s){return h(this,null,function*(){let o=co(t,r,n,s),a;try{a=yield i(e,Object.assign({},o))}catch(l){throw console.error(l),new Ee(ce(l),0)}if(a.ok||(yield Sn(a)),r?.noResolveJson)return a;try{return yield a.json()}catch(l){yield Sn(l)}})}function G(i){var t;let e=null;ho(i)&&(e=Object.assign({},i),i.expires_at||(e.expires_at=mn(i.expires_in)));let r=(t=i.user)!==null&&t!==void 0?t:i;return{data:{session:e,user:r},error:null}}function Or(i){let t=G(i);return!t.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((e,r)=>e&&typeof r=="string",!0)&&(t.data.weak_password=i.weak_password),t}function q(i){var t;return{data:{user:(t=i.user)!==null&&t!==void 0?t:i},error:null}}function kn(i){return{data:i,error:null}}function xn(i){let{action_link:t,email_otp:e,hashed_token:r,redirect_to:n,verification_type:s}=i,o=ao(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:e,hashed_token:r,redirect_to:n,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Dn(i){return i}function ho(i){return i.access_token&&i.refresh_token&&i.expires_in}var Gt=["global","local","others"];var fo=function(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(e[r[n]]=i[r[n]]);return e},Se=class{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=Lt(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(r){return h(this,arguments,function*(t,e=Gt[0]){if(Gt.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Gt.join(", ")}`);try{return yield y(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(m(n))return{data:null,error:n};throw n}})}inviteUserByEmail(r){return h(this,arguments,function*(t,e={}){try{return yield y(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:q})}catch(n){if(m(n))return{data:{user:null},error:n};throw n}})}generateLink(t){return h(this,null,function*(){try{let{options:e}=t,r=fo(t,["options"]),n=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(n.new_email=r?.newEmail,delete n.newEmail),yield y(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:xn,redirectTo:e?.redirectTo})}catch(e){if(m(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return h(this,null,function*(){try{return yield y(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:q})}catch(e){if(m(e))return{data:{user:null},error:e};throw e}})}listUsers(t){return h(this,null,function*(){var e,r,n,s,o,a,l;try{let c={nextPage:null,lastPage:0,total:0},u=yield y(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(s=(n=t?.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Dn});if(u.error)throw u.error;let d=yield u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(w=>{let _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(w.split(";")[1].split("=")[1]);c[`${v}Page`]=_}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(m(c))return{data:{users:[]},error:c};throw c}})}getUserById(t){return h(this,null,function*(){le(t);try{return yield y(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:q})}catch(e){if(m(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return h(this,null,function*(){le(t);try{return yield y(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:q})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}})}deleteUser(t,e=!1){return h(this,null,function*(){le(t);try{return yield y(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:q})}catch(r){if(m(r))return{data:{user:null},error:r};throw r}})}_listFactors(t){return h(this,null,function*(){le(t.userId);try{let{data:e,error:r}=yield y(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:e,error:r}}catch(e){if(m(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return h(this,null,function*(){le(t.userId),le(t.id);try{return{data:yield y(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(m(e))return{data:null,error:e};throw e}})}};var On={getItem:i=>X()?globalThis.localStorage.getItem(i):null,setItem:(i,t)=>{X()&&globalThis.localStorage.setItem(i,t)},removeItem:i=>{X()&&globalThis.localStorage.removeItem(i)}};function Tr(i={}){return{getItem:t=>i[t]||null,setItem:(t,e)=>{i[t]=e},removeItem:t=>{delete i[t]}}}function Tn(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var ue={debug:!!(globalThis&&X()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},tt=class extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}},qt=class extends tt{};function Ir(i,t,e){return h(this,null,function*(){ue.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,t);let r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),ue.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(i,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},n=>h(null,null,function*(){if(n){ue.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,n.name);try{return yield e()}finally{ue.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,n.name)}}else{if(t===0)throw ue.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new qt(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(ue.debug)try{let s=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}})))})}Tn();var po={url:tn,storageKey:rn,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:nn,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function In(i,t,e){return h(this,null,function*(){return yield e()})}var Vr=(()=>{class i{constructor(e){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=i.nextInstanceID,i.nextInstanceID+=1,this.instanceID>0&&R()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let s=Object.assign(Object.assign({},po),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Se({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Lt(s.fetch),this.lock=s.lock||In,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:R()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=Ir:this.lock=In,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:X()?this.storage=On:(this.memoryStorage={},this.storage=Tr(this.memoryStorage)):(this.memoryStorage={},this.storage=Tr(this.memoryStorage)),R()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",o=>h(this,null,function*(){this._debug("received broadcast notification from other tab or client",o),yield this._notifyAllSubscribers(o.data.event,o.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Pt}) ${new Date().toISOString()}`,...e),this}initialize(){return h(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=h(this,null,function*(){return yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return h(this,null,function*(){var e;try{let r=vn(window.location.href),n="none";if(this._isImplicitGrantCallback(r)?n="implicit":(yield this._isPKCECallback(r))&&(n="pkce"),R()&&this.detectSessionInUrl&&n!=="none"){let{data:s,error:o}=yield this._getSessionFromURL(r,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),cn(o)){let c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return yield this._removeSession(),{error:o}}let{session:a,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),yield this._saveSession(a),setTimeout(()=>h(this,null,function*(){l==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",a):yield this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(r){return m(r)?{error:r}:{error:new Ae("Unexpected error during initialization",r)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(e){return h(this,null,function*(){var r,n,s;try{let o=yield y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:G}),{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,u=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(m(o))return{data:{user:null,session:null},error:o};throw o}})}signUp(e){return h(this,null,function*(){var r,n,s;try{let o;if("email"in e){let{email:d,password:p,options:f}=e,w=null,_=null;this.flowType==="pkce"&&([w,_]=yield ae(this.storage,this.storageKey)),o=yield y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:d,password:p,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:w,code_challenge_method:_},xform:G})}else if("phone"in e){let{phone:d,password:p,options:f}=e;o=yield y(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:p,data:(n=f?.data)!==null&&n!==void 0?n:{},channel:(s=f?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:G})}else throw new ne("You must provide either an email or phone number and a password");let{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};let c=a.session,u=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(o){if(m(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithPassword(e){return h(this,null,function*(){try{let r;if("email"in e){let{email:o,password:a,options:l}=e;r=yield y(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Or})}else if("phone"in e){let{phone:o,password:a,options:l}=e;r=yield y(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Or})}else throw new ne("You must provide either an email or phone number and a password");let{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ie}:(n.session&&(yield this._saveSession(n.session),yield this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOAuth(e){return h(this,null,function*(){var r,n,s,o;return yield this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})})}exchangeCodeForSession(e){return h(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>h(this,null,function*(){return this._exchangeCodeForSession(e)}))})}signInWithWeb3(e){return h(this,null,function*(){let{chain:r}=e;if(r==="solana")return yield this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)})}signInWithSolana(e){return h(this,null,function*(){var r,n,s,o,a,l,c,u,d,p,f,w;let _,v;if("message"in e)_=e.message,v=e.signature;else{let{chain:b,wallet:x,statement:T,options:g}=e,C;if(R())if(typeof x=="object")C=x;else{let E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))C=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!g?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=x}let F=new URL((r=g?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in C&&C.signIn){let E=yield C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g?.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),T?{statement:T}:null)),V;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")V=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)V=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in V&&"signature"in V&&(typeof V.signedMessage=="string"||V.signedMessage instanceof Uint8Array)&&V.signature instanceof Uint8Array)_=typeof V.signedMessage=="string"?V.signedMessage:new TextDecoder().decode(V.signedMessage),v=V.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${F.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(s=(n=g?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=g?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((a=g?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((c=g?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g?.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((p=(d=g?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||p===void 0)&&p.length?["Resources",...g.signInWithSolana.resources.map(V=>`- ${V}`)]:[]].join(`
`);let E=yield C.signMessage(new TextEncoder().encode(_),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=E}}try{let{data:b,error:x}=yield y(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:gn(v)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:G});if(x)throw x;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new ie}:(b.session&&(yield this._saveSession(b.session),yield this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:x})}catch(b){if(m(b))return{data:{user:null,session:null},error:b};throw b}})}_exchangeCodeForSession(e){return h(this,null,function*(){let r=yield Ze(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{let{data:o,error:a}=yield y(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:G});if(yield et(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new ie}:(o.session&&(yield this._saveSession(o.session),yield this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:a})}catch(o){if(m(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}})}signInWithIdToken(e){return h(this,null,function*(){try{let{options:r,provider:n,token:s,access_token:o,nonce:a}=e,l=yield y(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:G}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new ie}:(c.session&&(yield this._saveSession(c.session),yield this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithOtp(e){return h(this,null,function*(){var r,n,s,o,a;try{if("email"in e){let{email:l,options:c}=e,u=null,d=null;this.flowType==="pkce"&&([u,d]=yield ae(this.storage,this.storageKey));let{error:p}=yield y(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){let{phone:l,options:c}=e,{data:u,error:d}=yield y(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(a=c?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:d}}throw new ne("You must provide either an email or phone number.")}catch(l){if(m(l))return{data:{user:null,session:null},error:l};throw l}})}verifyOtp(e){return h(this,null,function*(){var r,n;try{let s,o;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(n=e.options)===null||n===void 0?void 0:n.captchaToken);let{data:a,error:l}=yield y(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:G});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");let c=a.session,u=a.user;return c?.access_token&&(yield this._saveSession(c),yield this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(m(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithSSO(e){return h(this,null,function*(){var r,n,s;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=yield ae(this.storage,this.storageKey)),yield y(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:kn})}catch(o){if(m(o))return{data:null,error:o};throw o}})}reauthenticate(){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return h(this,null,function*(){try{return yield this._useSession(e=>h(this,null,function*(){let{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new P;let{error:s}=yield y(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}}))}catch(e){if(m(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return h(this,null,function*(){try{let r=`${this.url}/resend`;if("email"in e){let{email:n,type:s,options:o}=e,{error:a}=yield y(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){let{phone:n,type:s,options:o}=e,{data:a,error:l}=yield y(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:l}}throw new ne("You must provide either an email or phone number and a type")}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}})}getSession(){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return this._useSession(r=>h(this,null,function*(){return r}))}))})}_acquireLock(e,r){return h(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=h(this,null,function*(){return yield n,yield r()});return this.pendingInLock.push(h(this,null,function*(){try{yield s}catch{}})),s}return yield this.lock(`lock:${this.storageKey}`,e,()=>h(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let n=r();for(this.pendingInLock.push(h(this,null,function*(){try{yield n}catch{}})),yield n;this.pendingInLock.length;){let s=[...this.pendingInLock];yield Promise.all(s),this.pendingInLock.splice(0,s.length)}return yield n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return h(this,null,function*(){this._debug("#_useSession","begin");try{let r=yield this.__loadSession();return yield e(r)}finally{this._debug("#_useSession","end")}})}__loadSession(){return h(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,r=yield Ze(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};let n=e.expires_at?e.expires_at*1e3-Date.now()<Ft:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}let{session:s,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return h(this,null,function*(){return e?yield this._getUser(e):(yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._getUser()})))})}_getUser(e){return h(this,null,function*(){try{return e?yield y(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:q}):yield this._useSession(r=>h(this,null,function*(){var n,s,o;let{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new P}:yield y(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:q})}))}catch(r){if(m(r))return ln(r)&&(yield this._removeSession(),yield et(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}})}updateUser(n){return h(this,arguments,function*(e,r={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._updateUser(e,r)}))})}_updateUser(n){return h(this,arguments,function*(e,r={}){try{return yield this._useSession(s=>h(this,null,function*(){let{data:o,error:a}=s;if(a)throw a;if(!o.session)throw new P;let l=o.session,c=null,u=null;this.flowType==="pkce"&&e.email!=null&&([c,u]=yield ae(this.storage,this.storageKey));let{data:d,error:p}=yield y(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:u}),jwt:l.access_token,xform:q});if(p)throw p;return l.user=d.user,yield this._saveSession(l),yield this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}}))}catch(s){if(m(s))return{data:{user:null},error:s};throw s}})}setSession(e){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return h(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new P;let r=Date.now()/1e3,n=r,s=!0,o=null,{payload:a}=Bt(e.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){let{session:l,error:c}=yield this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{let{data:l,error:c}=yield this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(m(r))return{data:{session:null,user:null},error:r};throw r}})}refreshSession(e){return h(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var n;if(!e){let{data:a,error:l}=r;if(l)throw l;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new P;let{session:s,error:o}=yield this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}}))}catch(r){if(m(r))return{data:{user:null,session:null},error:r};throw r}})}_getSessionFromURL(e,r){return h(this,null,function*(){try{if(!R())throw new se("No browser detected.");if(e.error||e.error_description||e.error_code)throw new se(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ye("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new se("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ye("No code detected.");let{data:T,error:g}=yield this._exchangeCodeForSession(e.code);if(g)throw g;let C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:T.session,redirectType:null},error:null}}let{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=e;if(!o||!l||!a||!u)throw new se("No session defined in URL");let d=Math.round(Date.now()/1e3),p=parseInt(l),f=d+p;c&&(f=parseInt(c));let w=f-d;w*1e3<=re&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${p}s`);let _=f-p;d-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,d):d-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,f,d);let{data:v,error:b}=yield this._getUser(o);if(b)throw b;let x={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:p,expires_at:f,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(n){if(m(n))return{data:{session:null,redirectType:null},error:n};throw n}})}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}_isPKCECallback(e){return h(this,null,function*(){let r=yield Ze(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)})}signOut(){return h(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return h(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(r=>h(this,null,function*(){var n;let{data:s,error:o}=r;if(o)return{error:o};let a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){let{error:l}=yield this.admin.signOut(a,e);if(l&&!(an(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(yield this._removeSession(),yield et(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(e){let r=_n(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),h(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){this._emitInitialSession(r)}))}),{data:{subscription:n}}}_emitInitialSession(e){return h(this,null,function*(){return yield this._useSession(r=>h(this,null,function*(){var n,s;try{let{data:{session:o},error:a}=r;if(a)throw a;yield(n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){yield(s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}}))})}resetPasswordForEmail(n){return h(this,arguments,function*(e,r={}){let s=null,o=null;this.flowType==="pkce"&&([s,o]=yield ae(this.storage,this.storageKey,!0));try{return yield y(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(m(a))return{data:null,error:a};throw a}})}getUserIdentities(){return h(this,null,function*(){var e;try{let{data:r,error:n}=yield this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(m(r))return{data:null,error:r};throw r}})}linkIdentity(e){return h(this,null,function*(){var r;try{let{data:n,error:s}=yield this._useSession(o=>h(this,null,function*(){var a,l,c,u,d;let{data:p,error:f}=o;if(f)throw f;let w=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return yield y(this.fetch,"GET",w,{headers:this.headers,jwt:(d=(u=p.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})}));if(s)throw s;return R()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(m(n))return{data:{provider:e.provider,url:null},error:n};throw n}})}unlinkIdentity(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var n,s;let{data:o,error:a}=r;if(a)throw a;return yield y(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})}))}catch(r){if(m(r))return{data:null,error:r};throw r}})}_refreshAccessToken(e){return h(this,null,function*(){let r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{let n=Date.now();return yield bn(s=>h(this,null,function*(){return s>0&&(yield wn(200*Math.pow(2,s-1))),this._debug(r,"refreshing attempt",s),yield y(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:G})}),(s,o)=>{let a=200*Math.pow(2,s);return o&&$t(o)&&Date.now()+a-n<re})}catch(n){if(this._debug(r,"error",n),m(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}})}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,r){return h(this,null,function*(){let n=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),R()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}})}_recoverAndRefresh(){return h(this,null,function*(){var e;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let n=yield Ze(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&(yield this._removeSession());return}let s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Ft;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Ft}s`),s){if(this.autoRefreshToken&&n.refresh_token){let{error:o}=yield this._callRefreshToken(n.refresh_token);o&&(console.error(o),$t(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}})}_callRefreshToken(e){return h(this,null,function*(){var r,n;if(!e)throw new P;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Qe;let{data:o,error:a}=yield this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new P;yield this._saveSession(o.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(s,"error",o),m(o)){let a={session:null,error:o};return $t(o)||(yield this._removeSession()),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}})}_notifyAllSubscribers(e,r,n=!0){return h(this,null,function*(){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});let o=[],a=Array.from(this.stateChangeEmitters.values()).map(l=>h(this,null,function*(){try{yield l.callback(e,r)}catch(c){o.push(c)}}));if(yield Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(s,"end")}})}_saveSession(e){return h(this,null,function*(){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,yield Dr(this.storage,this.storageKey,e)})}_removeSession(){return h(this,null,function*(){this._debug("#_removeSession()"),yield et(this.storage,this.storageKey),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&R()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}_startAutoRefresh(){return h(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),re);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(()=>h(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return h(this,null,function*(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return h(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return h(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>h(this,null,function*(){try{let e=Date.now();try{return yield this._useSession(r=>h(this,null,function*(){let{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let s=Math.floor((n.expires_at*1e3-e)/re);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${re}ms, refresh threshold is ${Rt} ticks`),s<=Rt&&(yield this._callRefreshToken(n.refresh_token))}))}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(e.isAcquireTimeout||e instanceof tt)this._debug("auto refresh token tick lock not available");else throw e}})}_handleVisibilityChange(){return h(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!R()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>h(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return h(this,null,function*(){let r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>h(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,r,n){return h(this,null,function*(){let s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){let[o,a]=yield ae(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(n?.queryParams){let o=new URLSearchParams(n.queryParams);s.push(o.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`})}_unenroll(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var n;let{data:s,error:o}=r;return o?{data:null,error:o}:yield y(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(m(r))return{data:null,error:r};throw r}})}_enroll(e){return h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var n,s;let{data:o,error:a}=r;if(a)return{data:null,error:a};let l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=yield y(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})}))}catch(r){if(m(r))return{data:null,error:r};throw r}})}_verify(e){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var n;let{data:s,error:o}=r;if(o)return{data:null,error:o};let{data:a,error:l}=yield y(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})}))}catch(r){if(m(r))return{data:null,error:r};throw r}}))})}_challenge(e){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){try{return yield this._useSession(r=>h(this,null,function*(){var n;let{data:s,error:o}=r;return o?{data:null,error:o}:yield y(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})}))}catch(r){if(m(r))return{data:null,error:r};throw r}}))})}_challengeAndVerify(e){return h(this,null,function*(){let{data:r,error:n}=yield this._challenge({factorId:e.factorId});return n?{data:null,error:n}:yield this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})})}_listFactors(){return h(this,null,function*(){let{data:{user:e},error:r}=yield this.getUser();if(r)return{data:null,error:r};let n=e?.factors||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),o=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:o},error:null}})}_getAuthenticatorAssuranceLevel(){return h(this,null,function*(){return this._acquireLock(-1,()=>h(this,null,function*(){return yield this._useSession(e=>h(this,null,function*(){var r,n;let{data:{session:s},error:o}=e;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:a}=Bt(s.access_token),l=null;a.aal&&(l=a.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(p=>p.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");let d=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}))})}fetchJwk(n){return h(this,arguments,function*(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s||(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+on>Date.now()))return s;let{data:o,error:a}=yield y(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!o.keys||o.keys.length===0)throw new z("JWKS is empty");if(this.jwks=o,this.jwks_cached_at=Date.now(),s=o.keys.find(l=>l.kid===e),!s)throw new z("No matching signing key found in JWKS");return s})}getClaims(n){return h(this,arguments,function*(e,r={keys:[]}){try{let s=e;if(!s){let{data:_,error:v}=yield this.getSession();if(v||!_.session)return{data:null,error:v};s=_.session.access_token}let{header:o,payload:a,signature:l,raw:{header:c,payload:u}}=Bt(s);if(An(a.exp),!o.kid||o.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){let{error:_}=yield this.getUser(s);if(_)throw _;return{data:{claims:a,header:o,signature:l},error:null}}let d=En(o.alg),p=yield this.fetchJwk(o.kid,r),f=yield crypto.subtle.importKey("jwk",p,d,!0,["verify"]);if(!(yield crypto.subtle.verify(d,f,l,pn(`${c}.${u}`))))throw new z("Invalid JWT signature");return{data:{claims:a,header:o,signature:l},error:null}}catch(s){if(m(s))return{data:null,error:s};throw s}})}}return i.nextInstanceID=0,i})();var go=Vr,jr=go;var Ht=class extends jr{constructor(t){super(t)}};var mo=function(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(i,t||[])).next())})},Wt=class{constructor(t,e,r){var n,s,o;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");let a=Zi(t),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);let c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:Ki,realtime:Xi,auth:Object.assign(Object.assign({},Yi),{storageKey:c}),global:Ji},d=en(r??{},u);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(p,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=Qi(e,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Ii(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Pe(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new We(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return mo(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,storageKey:s,flowType:o,lock:a,debug:l},c,u){let d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ht({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:n,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new qe(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,"CLIENT",r?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var Vn=(i,t,e)=>new Wt(i,t,e);var Mr={production:!1,apiUrl:"https://gehbvrlfgpqxvzcleahc.supabase.co",publicAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdlaGJ2cmxmZ3BxeHZ6Y2xlYWhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyODYyMjQsImV4cCI6MjA2NTg2MjIyNH0.JUsPGiHemdJdDtwk8o6GSjnJcW2Yec7RXpt2oMyKirY"};var jn=class i{supabase=Vn(Mr.apiUrl,Mr.publicAnonKey);uploadAvatar(t,e){return this.supabase.storage.from("profile-pictures").upload(t,e)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=zt({token:i,factory:i.\u0275fac,providedIn:"root"})};export{Zr as a,qr as b,je as c,$o as d,No as e,pt as f,ps as g,gs as h,Bo as i,vs as j,ws as k,Go as l,qo as m,jn as n};
