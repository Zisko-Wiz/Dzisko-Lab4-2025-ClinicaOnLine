import{a as P,d as I,h as L,i as N,j as q,k as j,l as D,m as G,n as V,o as B}from"./chunk-UFL6QMOH.js";import{a as _,b as d,d as b,e as M,f as w,h as g,i as S,j as F,k as x,l as E,m as y,n as O}from"./chunk-4XUN7VXY.js";import"./chunk-LJ5XHLMQ.js";import{A as T,B as k}from"./chunk-SBXXUM2O.js";import{Ca as v,G as p,Ra as n,_ as l,fa as f,qa as m,qb as C,ra as s,rb as h,va as u,wa as e,xa as i,ya as c}from"./chunk-NKZF7QRB.js";import"./chunk-FK42CRUA.js";function A(t,o){t&1&&(e(0,"p",6),n(1,"*Correo o contrase\xF1a inv\xE1lidos"),i())}function z(t,o){t&1&&(e(0,"p",6),n(1,"*Cuenta no aprobada por administrador"),i())}function H(t,o){t&1&&(e(0,"p",6),n(1,"*Correo no confirmado"),i())}function W(t,o){t&1&&(e(0,"mat-error"),n(1,"Correo electr\xF3nico es "),e(2,"strong"),n(3,"obligatorio"),i()())}function J(t,o){t&1&&(e(0,"mat-error"),n(1,"Correo electr\xF3nico "),e(2,"strong"),n(3,"inv\xE1lido"),i()())}function K(t,o){t&1&&(e(0,"mat-error"),n(1,"Contrase\xF1a es "),e(2,"strong"),n(3,"obligatoria"),i()())}function Q(t,o){t&1&&(e(0,"mat-error"),n(1,"La contrase\xF1a debe tener m\xEDnimo 6 car\xE1cteres"),i())}var R=class t{supabaseService=p(O);router=p(C);error=!0;errorInvalido=!1;errorNoConfirmado=!1;verificated=null;loginForm=new w({email:new g("",[d.required,d.email]),password:new g("",[d.required,d.minLength(6)])});ngOnInit(){}getVerification(){this.supabaseService.supabase.from("users").select("verification").eq("email",this.loginForm.get("email")?.value).then(({data:o,error:r})=>{r?(console.log(r.message),console.log(r.code)):this.verificated=o[0].verification})}login(){this.supabaseService.supabase.auth.signInWithPassword({email:this.loginForm.get("email")?.value,password:this.loginForm.get("password")?.value}).then(({data:o,error:r})=>{if(this.errorInvalido=!1,this.errorNoConfirmado=!1,r)switch(console.log(r.code),r.code){case"email_not_confirmed":this.errorNoConfirmado=!0;break;default:break;case"invalid_credentials":this.errorInvalido=!0;break}else this.supabaseService.supabase.from("ingresos").insert([{usuario:o.user.email}]).then(({error:a})=>{a==null&&this.router.navigate(["/home"])})})}ingresar(){this.getVerification(),this.verificated&&this.login()}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=f({type:t,selectors:[["app-login"]],decls:35,vars:9,consts:[[1,"container"],[3,"ngSubmit","formGroup"],[1,"form-card"],[1,"row2"],["src","hospital.png",1,"logo"],[1,"col"],[1,"error"],[1,"full-width"],["matInput","","placeholder","Correo electr\xF3nico","formControlName","email"],["matInput","","type","password","placeholder","Contrase\xF1a","formControlName","password"],["type","button","id","cancel-btn","matButton","elevated","routerLink","/home"],[1,"submit-div"],["matButton","elevated","color","primary","type","submit",3,"disabled"],[1,"quick-acces"],["src","https://gehbvrlfgpqxvzcleahc.supabase.co/storage/v1/object/public/profile-pictures//wimevu-1.png",1,"img-btn"]],template:function(r,a){r&1&&(e(0,"div",0)(1,"form",1),v("ngSubmit",function(){return a.ingresar()}),e(2,"mat-card",2)(3,"mat-card-header")(4,"mat-card-title"),n(5,"Ingresar"),i()(),e(6,"div",3),c(7,"img",4),i(),e(8,"mat-card-content")(9,"div",5),m(10,A,2,0,"p",6),m(11,z,2,0,"p",6),m(12,H,2,0,"p",6),e(13,"mat-form-field",7),c(14,"input",8),m(15,W,4,0,"mat-error"),m(16,J,4,0,"mat-error"),i()(),e(17,"div",5)(18,"mat-form-field",7),c(19,"input",9),m(20,K,4,0,"mat-error"),m(21,Q,2,0,"mat-error"),i()()(),e(22,"div",3)(23,"button",10),n(24,"Cancelar"),i(),e(25,"mat-card-actions",11)(26,"button",12),n(27,"Ingresar"),i()()()()()(),e(28,"div",13),c(29,"img",14)(30,"img",14)(31,"img",14)(32,"img",14)(33,"img",14)(34,"img",14),i()),r&2&&(l(),u("formGroup",a.loginForm),l(9),s(a.errorInvalido?10:-1),l(),s(a.verificated==!1?11:-1),l(),s(a.errorNoConfirmado?12:-1),l(3),s(a.loginForm.controls.email.hasError("required")?15:-1),l(),s(a.loginForm.controls.email.hasError("email")?16:-1),l(4),s(a.loginForm.controls.password.hasError("required")?20:-1),l(),s(a.loginForm.controls.password.hasError("minlength")?21:-1),l(5),u("disabled",!a.loginForm.valid))},dependencies:[N,L,I,P,k,T,B,q,G,D,V,j,y,S,_,b,M,F,x,h,E],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.form-card[_ngcontent-%COMP%]{min-width:120px;margin:20px auto;width:70vw}.mat-radio-button[_ngcontent-%COMP%]{display:block;margin:5px 0}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.col[_ngcontent-%COMP%]{flex:1;margin-right:20px}.col[_ngcontent-%COMP%]:last-child{margin-right:0}.submit-div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}#cancel-btn[_ngcontent-%COMP%]{width:8%}.row2[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;align-content:center;padding-top:5vh}.logo[_ngcontent-%COMP%]{width:20vw;aspect-ratio:auto;margin-bottom:2vh}.error[_ngcontent-%COMP%]{color:red}.quick-acces[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}.img-btn[_ngcontent-%COMP%]{width:10vw}"]})};export{R as Login};
