import{m as M,o as l}from"./chunk-2RTL5LRQ.js";import{Ba as r,Ca as n,Da as C,F as g,Ha as O,I as f,Ja as k,Ka as x,L as v,M as b,Ya as s,Za as I,da as d,ha as a,ka as h,pa as c,va as S,wa as _,yb as y,zb as E}from"./chunk-3LGQCPDO.js";import{h as p}from"./chunk-FK42CRUA.js";var u=class t{constructor(e){this.supaService=e}isLogged=!1;user;userRole="invitado";emitter=new c;getUser(){this.supaService.supabase.auth.getUser().then(({data:e})=>{e.user!=null?(this.user=e.user,this.isLogged=!0,this.emitter.emit(e.user)):(this.isLogged=!1,this.emitter.emit(void 0))}).finally(()=>{this.getRole()})}getRole(){this.user&&this.supaService.supabase.from("users").select().eq("email",this.user.email).then(({data:e,error:i})=>{i?console.log(i.message):this.userRole=e[0].role})}static \u0275fac=function(i){return new(i||t)(f(l))};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};function L(t,e){if(t&1){let i=O();r(0,"li",3)(1,"button",4),k("click",function(){v(i);let m=x();return b(m.logOut())}),s(2,"Salir"),n()(),r(3,"li",3)(4,"button",5),s(5,"Usuarios"),n()()}}function R(t,e){t&1&&(r(0,"li",3)(1,"button",6),s(2,"Ingresar"),n()(),r(3,"li",3)(4,"button",7),s(5,"Registrarse"),n()())}var U=class t{constructor(e,i,o){this.router=e;this.supa=i;this.signInService=o}ingreso=!1;mensajeBienvenida="Bienvenido a la Cl\xEDnica OnLine";subscription;logginEmmiter=new c;ngOnInit(){this.getUser(),this.signInService.getUser()}ngOnDestroy(){this.subscription.unsubscribe()}logOut(){return p(this,null,function*(){this.supa.supabase.auth.signOut().then(({error:e})=>{e?console.error("Error: ",e.message):(this.signInService.getUser(),this.ingreso=!1,this.mensajeBienvenida="",this.router.navigate(["home"]))})})}getUser(){this.subscription=this.signInService.emitter.subscribe({next:e=>{e!=null&&(this.ingreso=!0)}})}setWelcomeMessage(){return p(this,null,function*(){if(this.signInService.user!=null){let{data:e,error:i}=yield this.supa.supabase.from("users").select("nickname").eq("uid",this.signInService.user?.id),o=e[0].nickname,m=o[0].toUpperCase()+o.slice(1);this.mensajeBienvenida="Bienvenido "+m}})}static \u0275fac=function(i){return new(i||t)(a(y),a(l),a(u))};static \u0275cmp=h({type:t,selectors:[["app-header"]],decls:12,vars:2,consts:[[1,"container"],["src","hospital.png","alt","logo",1,"logo",2,"float","left"],["routerLink","/home"],[2,"float","right"],[3,"click"],["routerLink","/usuarios"],["routerLink","/ingreso"],["routerLink","/registro"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"ul")(2,"li"),C(3,"img",1),n(),r(4,"li")(5,"button",2),s(6,"P\xE1gina principal"),n()(),r(7,"li")(8,"h1"),s(9),n()(),S(10,L,6,0)(11,R,6,0),n()()),i&2&&(d(9),I(o.mensajeBienvenida),d(),_(o.ingreso?10:11))},dependencies:[M,E],styles:[".container[_ngcontent-%COMP%]{position:sticky;top:0;z-index:5000}ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0;overflow:hidden;background-color:#333}li[_ngcontent-%COMP%]{float:left}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:block;color:#21c4b6;background-color:#333;text-align:center;padding:2vh 5vi;text-decoration:none;border:none}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#111}li[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:block;color:#21c4b6;font-size:100%;text-align:center;padding-top:2vh;margin:0}.logo[_ngcontent-%COMP%]{object-fit:contain;width:100%;height:6vh;-webkit-user-select:none;user-select:none}"]})};export{u as a,U as b};
